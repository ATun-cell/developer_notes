# 应用层
最上层，我们使用的应用软件斗是在应用层实现。
应用层是需要专注为用户提供应用功能，比如HTTP、FTP、Telnet、DNS、SMTP等
不用去关心数据是如何传输的
工作在操作系统中的用户态，传输层及以下则工作在内核态
****
# 传输层
****
应用层的数据会传给传输层，传输层是位应用层提供网络支持的
传输层有两个传输协议，分别是TCP和UDP
- TCP传输控制协议，大部分应用使用的是它，比如HTTP应用层协议。相比UDP多了很多特性，流量控制、超时重传、拥塞控制等负责数据包可以可靠的传输给对方
- UDP只负责发送数据包，不保证能成功抵达
TCP在传输大数据时会把数据分成一个个的TCP段，即使中途有分块丢失了，只需要重新发送这个分块

设备作为接收方式，传输方要负责把数据传给应用，但是一台设备上科恩那个会有很多个应用在接受或者传输数据，因此需要用一个编号将应用分开，这个编号就是端口。传输层报文中会携带端口号，因此接收方可以识别出该报文时发送给哪个应用
****
# 网络层
传输层只是为应用服务的，实际传输功能的实现是在网络层
最常使用的是IP协议，IP协议会将传输层的报文作为数据部分，再加上IP包头组装成IP报文，如果IP报文大小超过1500字节，就会再次进行分片，得到一个即将发送到网络中的IP报文

![[Pasted image 20250509163337.png]]
网络层一般用IP地址给设备进行编号，对于IPv4协议，IP地址32位，四段。为了方便寻址，IP地址分为两种意义
- 网络号，负责表示IP地址数据哪个子网
- 主机号，负责标识同一子网下的不同主机
需要配合子网掩码得到网络号和主机号，子网掩码与IP地址按位与运算就可以得到网络号。子网掩码取反后和IP地址按位与运算就可以得到主机号。

除了寻址能力，IP协议还有另一个重要的能力就是路由。网络中是存在很多节点的，数据包到达一个网络节点，就需要通过路由算法决定下一步走哪条路径
路由器就负责把数据包转发给对应的子网或者是离目标子网更近的路由器
****
# 网络接口层
生成了IP头部之后，网络接口层会再IP头部的前面加上MAC头部，并封装成数据帧发送到网络上

IP头部中的接收方IP地址表示网络包的目的地，通过这个地址可以判断要将包发送到哪里，但再以太网中这样不行
以太网在判断网络包目的地时和IP的方式不同，因此必须采用相匹配的方式才能在以太网中将包发往目的地，这就是MAC头部的作用，在以太网中进行通讯要用到MAC地址

MAC头部是以太网使用的头部，包含了接收方和发送方的MAC地址等信息，我们可以通过ARP协议获取对方的MAC地址
所以说，网络接口层主要位网络层提供链路级别传输的服务，负责在以太网、wifi这样的底层网络上发送原始数据包，工作在网卡这个层次，使用MAC地址来表示网络上的设备