![[Pasted image 20250521200705.png]]
****
# 第一次同步
![[Pasted image 20250521200826.png]]
主从服务器之间的第一次同步过程可分为三个阶段
- 建立链接，协商同步
- 主服务器同步数据给从服务器
- 主服务器发送新写操作命令给从服务器

# 命令传播
主从服务器完成第一次同步之后，双方之间会维护一个TCP链接
将写操作命令传播给从服务器

# 分摊主服务器的压力
![[Pasted image 20250521201631.png]]

# 增量复制
网络断开之后，重新连接的时候会采用增量复制的方式继续同步
不过还取决于repl_backlog_size的大小，如果过小，网络恢复时，可能从服务器想读的数据已经被覆盖了，那么这时会导致主服务器采用全量复制的方式。为了避免这中情况发生，要调大这个参数的值

