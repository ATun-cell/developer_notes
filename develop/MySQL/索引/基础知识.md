# 索引的分类
****
## 按数据结构分类
![[Pasted image 20250513101333.png]]
B+Tree索引类型也是存储引擎采用最多的索引类型
在创建表时
- 如果有主键，默认使用主键作为聚簇索引的索引键
- 没有主键，就选择第一个不包含NULL值得唯一列作为聚簇索引的索引键
- 都没有时，存储引擎自动生成一个隐式自增ID列作为索引键
其它索引都属于辅助索引，也叫做二级索引或非聚簇索引。创建的主键索引和二级索引默认使用的时B+Tree索引。
B+Tree索引相比B树和二叉树来说，最大的于是在于查询效率很高，即使在数据量很大的情况，查询一个数据的磁盘读写依然维持在3到4次

如果使用二级索引查询商品，会先检索耳机索引中的B+Tree的索引值，找到对应的叶子节点获取里面的主键值，然后再通过主键索引中的B+Tree树查询到对应的叶子节点然后获取整行数据。这个过程叫回表，也就是说要查两个B+Tree才能查到数据
![[Pasted image 20250513102725.png]]

在二级索引的B+Tree就能查询到结果的过程就叫做覆盖索引，也就是只需要查到一个B+Tree就能找到数据

## 按物理存储分类
索引分为聚簇索引（主键索引）和二级索引（辅助索引）

## 按字段特性分类
分为主键索引，唯一索引，普通索引，前缀索引
前缀索引是指对字符类型字段的前几个字符建立的索引，而不是在整个字段建立的索引

## 按字段个数分类
分为单列索引、联合索引
联合索引图示
![[Pasted image 20250513104412.png]]
使用联合索引时存在最左匹配原则，按照最左优先的方式进行索引的匹配。如果不遵循最左匹配原则，联合索引会失效
![[Pasted image 20250513105217.png]]

# 什么时候适用索引
- 字段有唯一性限制的，比如商品编码
- 经常用于where查询条件的字段，如果查询条件不是一个字段，可以建立联合索引
- 进程用于group by和order by的字段，这样在查询的时候就不需要再去做一次排序了

# 什么时候不需要常见索引
- where条件，group by ，order by里用不到的字段
- 字段中存到大量重复数据
- 表数据太少
- 经常更新的字段

# 优化索引的方法
## 前缀索引优化
减小索引项的大小
## 覆盖索引优化
查询的字段可以直接从索引项中获取结果而不需要回表操作
## 主键索引最好是自增
- 写入数据都是追加操作，不需要重新移动数据
## 最好设置为NOT NULL
- 存在null导致优化器做索引选择的时候更加复杂
- 占用至少1字节的空间存储NULL值列表
## 防止索引失效
发生索引失效的情况
- 使用左或左右模糊匹配的时候
- 在查询条件中对索引列做了计算、函数、类型转换操作
- 联合索引没有遵循最左匹配原则
- where子句中or前的条件列是索引列，后的条件列不是索引列
**要学会查看执行计划**
![[Pasted image 20250513150750.png]]
